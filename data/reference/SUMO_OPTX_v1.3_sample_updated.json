{
  "version": "1.3",
  "snap": {"step_m": 5, "tie_break": "toward_west"},
  "defaults": {"minor_road_length_m": 120, "ped_crossing_width_m": 3.5, "sidewalk_width_m": 2.0, "speed_kmh": 50},
  "main_road": {"length_m": 1500, "center_gap_m": 6.0, "lanes": 3},
  "junction_templates": {
    "tee": [
      {
        "id": "T1_compact_minor_bias",
        "main_approach_begin_m": 100,
        "main_approach_lanes": 4,
        "minor_lanes_to_main": 2,
        "minor_lanes_from_main": 1,
        "median_continuous": false
      },
      {
        "id": "T2_split_peds_major",
        "main_approach_begin_m": 120,
        "main_approach_lanes": 4,
        "minor_lanes_to_main": 3,
        "minor_lanes_from_main": 2,
        "median_continuous": false
      },
      {
        "id": "T3_keep_main_lanes",
        "main_approach_begin_m": 0,
        "main_approach_lanes": 0,
        "minor_lanes_to_main": 2,
        "minor_lanes_from_main": 2,
        "median_continuous": true
      }
    ],
    "cross": [
      {
        "id": "X1_4x4_split_peds",
        "main_approach_begin_m": 150,
        "main_approach_lanes": 5,
        "minor_lanes_to_main": 3,
        "minor_lanes_from_main": 3,
        "median_continuous": false
      },
      {
        "id": "X2_4x4_median_cont",
        "main_approach_begin_m": 80,
        "main_approach_lanes": 4,
        "minor_lanes_to_main": 2,
        "minor_lanes_from_main": 2,
        "median_continuous": true
      }
    ]
  },
  "signal_profiles": {
    "tee": [
      {
        "id": "tee_urban_90_3phase",
        "cycle_s": 90,
        "ped_early_cutoff_s": 6,
        "yellow_duration_s": 4,
        "pedestrian_conflicts": {"left": false, "right": false},
        "phases": [
          { "duration_s": 28, "allow_movements": ["main_T", "pedestrian"              ] },
          { "duration_s": 14, "allow_movements": ["main_R", "minor_L",    "pedestrian"] },
          { "duration_s": 48, "allow_movements": ["main_L", "minor_R",    "pedestrian"] }
        ]
      },
      {
        "id": "tee_split_minor_100_4phase",
        "cycle_s": 100,
        "ped_early_cutoff_s": 6,
        "yellow_duration_s": 4,
        "pedestrian_conflicts": {"left": true, "right": true},
        "phases": [
          { "duration_s": 40, "allow_movements": ["main_L",     "main_T",  "main_R", "pedestrian"] },
          { "duration_s": 20, "allow_movements": ["pedestrian"                                   ] },
          { "duration_s": 40, "allow_movements": ["minor_L",    "minor_R", "main_L", "pedestrian"] }
        ]
      }
    ],
    "cross": [
      {
        "id": "cross_urban_100_4phase",
        "cycle_s": 100,
        "ped_early_cutoff_s": 6,
        "yellow_duration_s": 4,
        "pedestrian_conflicts": {"left": false, "right": true},
        "phases": [
          { "duration_s": 30, "allow_movements": ["main_T",  "main_L",     "pedestrian"] },
          { "duration_s": 16, "allow_movements": ["main_R",  "pedestrian"              ] },
          { "duration_s": 36, "allow_movements": ["minor_T", "minor_L",    "minor_R"   ] },
          { "duration_s": 18, "allow_movements": ["minor_R", "pedestrian"              ] }
        ]
      },
      {
        "id": "cross_protL_120_6phase",
        "cycle_s": 120,
        "ped_early_cutoff_s": 7,
        "yellow_duration_s": 4,
        "pedestrian_conflicts": {"left": true, "right": false},
        "phases": [
          { "duration_s": 10, "allow_movements": ["main_T",     "main_L",     "EB_R",       "pedestrian"] },
          { "duration_s": 28, "allow_movements": ["EB_L",       "EB_T",       "EB_R",       "pedestrian"] },
          { "duration_s": 14, "allow_movements": ["pedestrian"                                          ] },
          { "duration_s": 28, "allow_movements": ["minor_L",    "minor_T",    "pedestrian"              ] },
          { "duration_s": 30, "allow_movements": ["minor_R",    "pedestrian"                            ] },
          { "duration_s": 10, "allow_movements": ["pedestrian"                                          ] }
        ]
      }
    ],
    "xwalk_midblock": [
      {
        "id": "xwalk_mid_70_three_phase",
        "cycle_s": 70,
        "yellow_duration_s": 6,
        "phases": [
          { "duration_s": 46, "allow_movements": ["main_T"    ] },
          { "duration_s": 24, "allow_movements": ["pedestrian"] }
        ]
      },
      {
        "id": "xwalk_mid_60_two_phase",
        "cycle_s": 60,
        "yellow_duration_s": 4,
        "phases": [
          { "duration_s": 40, "allow_movements": ["main_T"    ] },
          { "duration_s": 20, "allow_movements": ["pedestrian"] }
        ]
      }
    ]
  },
  "layout": [
    {
      "type": "xwalk_midblock",
      "pos_m": 200,
      "refuge_island_on_main": true,
      "signalized": true,
      "two_stage_tll_control": true,
      "signal": {"profile_id": "xwalk_mid_70_three_phase", "offset_s": 5}
    },
    {
      "type": "tee",
      "pos_m": 350,
      "branch": "north",
      "template": "T1_compact_minor_bias",
      "main_u_turn_allowed": true,
      "refuge_island_on_main": false,
      "signalized": false,
      "main_ped_crossing_placement": {"west": true, "east": false}
    },
    {
      "type": "cross",
      "pos_m": 650,
      "template": "X1_4x4_split_peds",
      "main_u_turn_allowed": false,
      "refuge_island_on_main": true,
      "signalized": true,
      "two_stage_tll_control": true,
      "signal": {"profile_id": "cross_urban_100_4phase", "offset_s": 20},
      "main_ped_crossing_placement": {"west": true, "east": true}
    },
    {
      "type": "tee",
      "pos_m": 900,
      "branch": "south",
      "template": "T2_split_peds_major",
      "main_u_turn_allowed": true,
      "refuge_island_on_main": true,
      "signalized": true,
      "two_stage_tll_control": true,
      "signal": {"profile_id": "tee_urban_90_3phase", "offset_s": 12},
      "main_ped_crossing_placement": {"west": false, "east": true}
    },
    {"type": "xwalk_midblock", "pos_m": 1050, "refuge_island_on_main": false, "signalized": false},
    {
      "type": "cross",
      "pos_m": 1000,
      "template": "X2_4x4_median_cont",
      "main_u_turn_allowed": true,
      "refuge_island_on_main": false,
      "signalized": true,
      "signal": {"profile_id": "cross_protL_120_6phase", "offset_s": 35},
      "main_ped_crossing_placement": {"west": false, "east": true}
    }
  ]
}
